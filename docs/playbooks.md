# Playbooks Documentation

## Core Playbooks (Automatically Run)

These playbooks are executed automatically by `playbook-main.yml`:

### play-AA-preflight-sanity.yml
**Purpose**: Validates system requirements  
**Actions**:
- Verifies Ansible version >= 2.9.9
- Confirms Fedora distribution and version
- Ensures system matches target in `vars/fedora-version.yml`

### play-basic-configs.yml
**Purpose**: Essential system configuration  
**Actions**:
- Installs basic packages (vim, wget, bash-completion, htop, etc.)
- Configures passwordless sudo for user
- Sets up Vim with Deus colorscheme
- Configures bash environment and custom PS1 prompt
- Copies SSH keys to root user
- Installs YQ binary
- Optimizes DNF with parallel downloads
- Configures hardware settings

### play-nvm-install.yml
**Purpose**: Node.js environment setup  
**Actions**:
- Installs Node Version Manager (NVM)
- Installs Node.js version 20
- Sets up bash integration

### play-claude-code.yml
**Purpose**: Claude Code CLI installation  
**Actions**:
- Downloads and installs Claude Code binary
- Configures system-wide access

### play-git-configure-and-tools.yml
**Purpose**: Git environment configuration  
**Actions**:
- Configures git user name and email
- Installs bash-git-prompt with Solarized theme
- Sets up ripgrep for fast searching
- Installs GitHub CLI (gh)
- Note: SSH keys are generated by run.bash as ~/.ssh/id (Ed25519)
- Configures SSH for LXC containers

### play-lxc-install-config.yml
**Purpose**: Container support  
**Actions**:
- Installs LXC and LXD packages
- Configures container networking
- Sets up SSH configuration for containers
- Configures firewall rules

### play-ms-fonts.yml
**Purpose**: Microsoft fonts installation  
**Actions**:
- Installs Windows-compatible fonts
- Configures font rendering

### play-rpm-fusion.yml
**Purpose**: Third-party repository setup  
**Actions**:
- Enables RPM Fusion free and non-free repositories
- Required for many multimedia codecs and proprietary software

### play-toolbox-install.yml
**Purpose**: JetBrains Toolbox installation  
**Actions**:
- Downloads and installs JetBrains Toolbox
- Configures desktop integration

## Optional Playbooks

Run these manually as needed with:
```bash
ansible-playbook playbooks/imports/optional/<category>/<playbook>.yml
```

### Common Optional Features

#### play-install-flatpaks.yml
Installs Flatpak applications:
- Enables Flathub repository
- Installs Slack

#### play-docker.yml
Docker container platform:
- Adds Docker repository
- Installs Docker CE and tools
- Configures user permissions
- Enables Docker service

#### play-firefox.yml
Firefox enhancements:
- Installs Firefox package
- Installs Firefox Profile Switcher Connector
- Sets up policies from files/etc/firefox/policies/policies.json

#### play-github-cli-multi.yml
Multi-account GitHub CLI configuration:
- Configures multiple GitHub accounts
- Sets up account switching
- Manages authentication tokens

#### play-gnome-shell.yml & play-gnome-shell-extensions.yml
GNOME desktop customization:
- Installs shell extensions
- Configures extension settings

#### play-golang.yml
Go programming language:
- Installs Go compiler and tools

#### play-gsettings.yml
Desktop settings configuration:
- Applies custom GNOME settings via gsettings

#### play-hd-audio.yml
Audio system enhancements:
- Configures PipeWire for high-quality audio
- Sets up Bluetooth audio codecs
- Optimizes audio latency

#### play-python.yml
Python development environment:
- Installs Python packages
- Configures pyenv for version management
- Sets up PDM package manager
- Installs Hugging Face tools

#### play-vscode.yml
Visual Studio Code installation:
- Adds Microsoft repository
- Installs VS Code

#### play-vpn.yml
VPN client setup:
- Installs WireGuard tools
- Configures VPN connections

#### play-cloudflare-warp.yml
Cloudflare WARP client:
- Installs WARP VPN client

#### play-lastpass.yml
Password manager:
- Installs LastPass CLI
- Configures accounts

#### play-qobuz-cli.yml
Music streaming:
- Installs Qobuz CLI tools
- Configures Last.fm scrobbling
- Sets up rescrobbled service

### Hardware-Specific

#### play-nvidia.yml
NVIDIA GPU drivers:
- Installs proprietary NVIDIA drivers
- Configures kernel modules

#### play-displaylink.yml
DisplayLink dock support:
- Installs DisplayLink drivers
- Creates suspend/resume service
- Configures display management

### Experimental

#### play-lxde-install.yml
Lightweight desktop environment:
- Installs LXDE as alternative to GNOME

#### play-virtualbox-windows.yml
Windows virtualization:
- Installs VirtualBox
- Configures Windows VM support
- Sets up ACPI tools

### Archived

#### play-tlp-battery-optimisation.yml
Laptop power management (deprecated):
- TLP battery optimization
- Note: Conflicts with newer power-profiles-daemon

## Running Optional Playbooks

```bash
# Install Flatpak applications
ansible-playbook playbooks/imports/optional/common/play-install-flatpaks.yml

# Set up Docker
ansible-playbook playbooks/imports/optional/common/play-docker.yml

# Install NVIDIA drivers
ansible-playbook playbooks/imports/optional/hardware-specific/play-nvidia.yml

# Configure multiple GitHub accounts
ansible-playbook playbooks/imports/optional/common/play-github-cli-multi.yml
```

## Creating Custom Playbooks

Place custom playbooks in `playbooks/imports/optional/` following the naming convention `play-<feature>.yml`.

Template:
```yaml
- hosts: desktop
  name: Your Feature Name
  become: true  # If root required
  vars:
    root_dir: "{{ inventory_dir }}/../../"
  vars_files:
    - "{{ root_dir }}/vars/fedora-version.yml"  # If version-specific
  tasks:
    - name: Your task here
      package:
        name: your-package
        state: present
```